import{u as j,f as te,g as ae,h as z,i as le,P as se,t as re,j as oe,k as S,l as H,m as ue,n as U,p as a,q as ie,R as T,s as ne,v as ce,x as Ee,C as ve,y as he,z as ge,A as de,B as me,D as pe,E as ye,F as Be,G as I,H as O,I as Ae,J as D,K as Fe}from"./app-jYPNnZCE.js";const Ce=["/","/intro.html","/blog/FFmpeg%E5%AD%A6%E4%B9%A0.html","/blog/FFmpeg%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html","/blog/GPTSoVITS%20UI.html","/blog/Windows%E8%84%9A%E6%9C%AC%E5%B0%8F%E7%9F%A5%E8%AF%86.html","/blog/ass%E5%AD%97%E5%B9%95%E6%A0%BC%E5%BC%8F.html","/blog/ffmpeg%E5%85%A5%E9%97%A8.html","/blog/how_to_create_this_blog.html","/blog/%E5%8F%8C%E8%AF%AD%E5%AD%97%E5%B9%95%E7%94%9F%E6%88%90%E5%BA%94%E7%94%A8.html","/blog/%E5%B9%BB%E7%81%AF%E7%89%87%E5%8A%9F%E8%83%BD%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95.html","/gamedev/Godot%20bug.html","/gamedev/Godot%20%E4%B8%BB%E9%A2%98.html","/gamedev/GodotVideoPlayer.html","/gamedev/Godot%E5%AE%9E%E7%94%A8%E5%B0%8F%E7%9F%A5%E8%AF%86.html","/gamedev/Godot%E7%BB%84%E4%BB%B6%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95.html","/gamedev/LearnOpenGL.html","/gamedev/tcp_udp_websocket%20in%20Godot.html","/gamedev/%E4%BD%BF%E7%94%A8Godot%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html","/gameengine/C__%E5%9F%BA%E7%A1%80.html","/gameengine/CMake%E5%9F%BA%E7%A1%80.html","/gameengine/CMake%E8%BF%9B%E9%98%B6.html","/gameengine/Hazel%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E.html","/gameengine/Hazel%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E%E5%BC%80%E5%8F%9101.html","/gameengine/Hazel%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E%E5%BC%80%E5%8F%9102.html","/notes/%E5%8D%9A%E5%BC%88%E8%AE%BA/%E5%8D%9A%E5%BC%88%E8%AE%BA00.html","/notes/%E5%8D%9A%E5%BC%88%E8%AE%BA/%E5%8D%9A%E5%BC%88%E8%AE%BA01.html","/notes/%E5%8D%9A%E5%BC%88%E8%AE%BA/%E5%8D%9A%E5%BC%88%E8%AE%BA02.html","/404.html","/blog/","/gamedev/","/gameengine/","/notes/%E5%8D%9A%E5%BC%88%E8%AE%BA/","/notes/","/category/","/category/game/","/category/blog/","/category/note/","/category/python/","/category/gamedev/","/category/coding/","/category/gameengine/","/tag/","/tag/hazel/","/tag/ffmpeg/","/tag/ai/","/tag/godot/","/tag/windows/","/tag/specification/","/tag/vuepress/","/tag/git/","/tag/python/","/tag/pyglet/","/tag/cpp/","/article/","/star/","/timeline/"],fe="SEARCH_PRO_QUERY_HISTORY",p=j(fe,[]),He=()=>{const{queryHistoryCount:l}=D,s=l>0;return{enabled:s,queryHistory:p,addQueryHistory:r=>{s&&(p.value=Array.from(new Set([r,...p.value.slice(0,l-1)])))},removeQueryHistory:r=>{p.value=[...p.value.slice(0,r),...p.value.slice(r+1)]}}},_=l=>Ce[l.id]+("anchor"in l?`#${l.anchor}`:""),De="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:$}=D,y=j(De,[]),be=()=>{const l=$>0;return{enabled:l,resultHistory:y,addResultHistory:s=>{if(l){const r={link:_(s),display:s.display};"header"in s&&(r.header=s.header),y.value=[r,...y.value.slice(0,$-1)]}},removeResultHistory:s=>{y.value=[...y.value.slice(0,s),...y.value.slice(s+1)]}}},ke=l=>{const s=ve(),r=z(),b=he(),u=S(0),F=H(()=>u.value>0),g=ge([]);return de(()=>{const{search:d,terminate:k}=me(),B=Ae(c=>{const A=c.join(" "),{searchFilter:R=h=>h,splitWord:w,suggestionsFilter:L,...m}=s.value;A?(u.value+=1,d(c.join(" "),r.value,m).then(h=>R(h,A,r.value,b.value)).then(h=>{u.value-=1,g.value=h}).catch(h=>{console.warn(h),u.value-=1,u.value||(g.value=[])})):g.value=[]},D.searchDelay-D.suggestDelay);U([l,r],([c])=>B(c),{immediate:!0}),pe(()=>{k()})}),{isSearching:F,results:g}};var we=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:s}){const r=ae(),b=z(),u=le(se),{enabled:F,addQueryHistory:g,queryHistory:d,removeQueryHistory:k}=He(),{enabled:B,resultHistory:c,addResultHistory:A,removeResultHistory:R}=be(),w=F||B,L=re(l,"queries"),{results:m,isSearching:h}=ke(L),o=oe({isQuery:!0,index:0}),E=S(0),v=S(0),G=H(()=>w&&(d.value.length>0||c.value.length>0)),Q=H(()=>m.value.length>0),q=H(()=>m.value[E.value]||null),M=()=>{const{isQuery:e,index:t}=o;t===0?(o.isQuery=!e,o.index=e?c.value.length-1:d.value.length-1):o.index=t-1},V=()=>{const{isQuery:e,index:t}=o;t===(e?d.value.length-1:c.value.length-1)?(o.isQuery=!e,o.index=0):o.index=t+1},Y=()=>{E.value=E.value>0?E.value-1:m.value.length-1,v.value=q.value.contents.length-1},J=()=>{E.value=E.value<m.value.length-1?E.value+1:0,v.value=0},K=()=>{v.value<q.value.contents.length-1?v.value+=1:J()},W=()=>{v.value>0?v.value-=1:Y()},x=e=>e.map(t=>Fe(t)?t:a(t[0],t[1])),N=e=>{if(e.type==="customField"){const t=ye[e.index]||"$content",[i,f=""]=Be(t)?t[b.value].split("$content"):t.split("$content");return e.display.map(n=>a("div",x([i,...n,f])))}return e.display.map(t=>a("div",x(t)))},C=()=>{E.value=0,v.value=0,s("updateQuery",""),s("close")},X=()=>F?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},u.value.queryHistory),d.value.map((e,t)=>a("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===t}],onClick:()=>{s("updateQuery",e)}},[a(I,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},e),a("button",{class:"search-pro-remove-icon",innerHTML:O,onClick:i=>{i.preventDefault(),i.stopPropagation(),k(t)}})]))])):null,Z=()=>B?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},u.value.resultHistory),c.value.map((e,t)=>a(T,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===t}],onClick:()=>{C()}},()=>[a(I,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[e.header?a("div",{class:"content-header"},e.header):null,a("div",e.display.map(i=>x(i)).flat())]),a("button",{class:"search-pro-remove-icon",innerHTML:O,onClick:i=>{i.preventDefault(),i.stopPropagation(),R(t)}})]))])):null;return ue("keydown",e=>{if(l.isFocusing){if(Q.value){if(e.key==="ArrowUp")W();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const t=q.value.contents[v.value];g(l.queries.join(" ")),A(t),r.push(_(t)),C()}}else if(B){if(e.key==="ArrowUp")M();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const{index:t}=o;o.isQuery?(s("updateQuery",d.value[t]),e.preventDefault()):(r.push(c.value[t].link),C())}}}}),U([E,v],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>a("div",{class:["search-pro-result-wrapper",{empty:l.queries.length?!Q.value:!G.value}],id:"search-pro-results"},l.queries.length?h.value?a(ie,{hint:u.value.searching}):Q.value?a("ul",{class:"search-pro-result-list"},m.value.map(({title:e,contents:t},i)=>{const f=E.value===i;return a("li",{class:["search-pro-result-list-item",{active:f}]},[a("div",{class:"search-pro-result-title"},e||u.value.defaultTitle),t.map((n,ee)=>{const P=f&&v.value===ee;return a(T,{to:_(n),class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{g(l.queries.join(" ")),A(n),C()}},()=>[n.type==="text"?null:a(n.type==="title"?ne:n.type==="heading"?ce:Ee,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?a("div",{class:"content-header"},n.header):null,a("div",N(n))])])})])})):u.value.emptyResult:w?G.value?[X(),Z()]:u.value.emptyHistory:u.value.emptyResult)}});export{we as default};
